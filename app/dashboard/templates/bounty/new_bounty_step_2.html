<form-wrapper v-if="step === 2" :heading="'Bounty Details'" :current-step="step" :total-steps="currentSteps.length"
  @update-navigation="updateNav">

  <!-- Bounty Information -->
  <div class="mb-4">
    <label class="mb-1 font-subheader font-weight-normal letter-spacing">Bounty information</label>

    <div class="btn-group-toggle d-flex flex-column flex-lg-row flex-wrap pt-1">
      <label
        v-bind:class="'btn btn-radio text-left chain-btn mr-2 mb-2 py-2 px-2 bounty-information-label ' + ((form.bountyInformationSource == 0)?'active':'')">
        <input type="radio" name="bounty_information" value="0" v-model="form.bountyInformationSource">
        <div class="p-1">
          <p class="m-0 text-grey-500 font-subheader">Import from GitHub</p>
          <p class="m-0 text-grey-400 mt-1">Import details from a GitHub issue</p>
        </div>
      </label>
      <label
        v-bind:class="'btn btn-radio text-left chain-btn mr-2 mb-2 py-2 px-2 bounty-information-label ' + ((form.bountyInformationSource == 1)?'active':'')">
        <input type="radio" name="bounty_information" value="1" v-model="form.bountyInformationSource">
        <div class="p-1">
          <p class="m-0 text-grey-500 font-subheader">Create Custom Bounty</p>
          <p class="m-0 text-grey-400 mt-1">Create a new bounty from scratch</p>
        </div>
      </label>
    </div>
  </div>

  <div v-if="form.bountyInformationSource !== null">
    <!-- GitHub Issue Url -->
    <div v-if="form.bountyInformationSource === '0'" class="mb-4">
      <label class="mb-1 font-subheader font-weight-normal letter-spacing">GitHub Issue Url</label>
      <input class="form-control" id="new-bounty-issue-url" name='issueURL' v-model="form.issueUrl" type="url"
        placeholder="https://github.com/org/repo/issues/n" @input="getIssueDetails(form.issueUrl)"
        value="{% if issueURL %}{{ issueURL }}{% endif %}" required />
    </div>

    <!-- GitHub Issue Title -->
    <div v-if="form.bountyInformationSource === '0' && form.issueDetails" class="mb-4">
      <label class="mb-1 font-subheader font-weight-normal letter-spacing">Title</label>
      <input class="form-control" id="new-bounty-title" name='title' v-model="form.title"
        :readonly="true" required />
    </div>

    <!-- GitHub Issue Details -->
    <div v-if="form.bountyInformationSource === '0' && form.issueDetails" class="mb-4">
      <label class="mb-1 font-subheader font-weight-normal letter-spacing">Description</label>

      <a class="btn btn-link" :href="form.issueUrl" target="_blank" rel="noopener noreferrer">
        Edit on Github <i class="far fa-external-link"></i>
      </a>

      <a class="btn btn-link" @click="getIssueDetails(form.issueUrl)">
        Resync with GitHub<i class="far fa-sync ml-1"></i>
      </a>

      <div class="issue_description mb-3" :inner-html.prop="form.issueDetails.description | markdownit"></div>
    </div>

    <!-- Custom Bounty Title -->
    <div v-if="form.bountyInformationSource === '1'" class="mb-4">
      <label class="mb-1 font-subheader font-weight-normal letter-spacing">Title</label>

      <input class="form-control" id="new-bounty-custom-title" name='title' v-model="form.title" required />
    </div>

    <!-- Custom Bounty Details Editor -->
    <div v-if="form.bountyInformationSource === '1'" class="mb-4">
      <label class="mb-1 font-subheader font-weight-normal letter-spacing">Description</label>

      <quill-editor id="new-bounty-custom-editor" @change="quilUpdated($event)"
        :class="`editor ${errors.description && !form.description_rich.length ? 'invalid' : ''}`"
        :options="editorOptionPrio" v-model="form.richDescription"></quill-editor>
    </div>
    
    <!-- Acceptance Criteria -->
    <div class="mb-4">
      <label class="mb-1 font-subheader font-weight-normal letter-spacing">Acceptance Criteria <i class="far fa-times" @click="popover('#new-bounty-acceptace-criteria')" ></i></label>
      <textarea id="new-bounty-acceptace-criteria" class="form-control" name='acceptanceCriteria' v-model="form.acceptanceCriteria"
        placeholder="What is the deliverable and acceptance criteria for this bounty?" rows="5" required></textarea>
    </div>

    <!-- Ressources -->
    <div class="mb-4">
      <label class="mb-1 font-subheader font-weight-normal letter-spacing">Ressources</label>
      <textarea id="new-bounty-resources" class="form-control" name='resources' v-model="form.resources"
        placeholder="Useful resources for working on this bounty (documentations, tutorials, etc.)" rows="5" required></textarea>
    </div>

    <!-- Contact Details -->
    <div class="mb-4">
      <label class="mb-1 font-subheader font-weight-normal letter-spacing">Contact Details</label>
      <p class="text-muted mb-0">How should the contributor get in touch with you / the team? Enter Discord handle /
        Telegram / email address</p>

      <div v-for="(details, index) in form.contactDetails" v-bind:class="'form-row mt-1 new-bounty-contact-details-form-' + index">
        <div class="col">
          <v-select class="new-bounty-contact-type" :required="'true'" :options="$root.contactDetailsType" v-model="details.type">
            <template #search="{attributes, events}">
              <input
                class="vs__search"
                :required="!details.type"
                v-bind="attributes"
                v-on="events"
              />
            </template>
          </v-select>
        </div>

        <div class="col">
          <div class="input-group is-invalid">
            <input name="contact-value" type="text" placeholder="mydiscord#1234" class="form-control new-bounty-contact-value" v-model="details.value">
            <div class="input-group-append">
              <button type="button"
                v-bind:class="'new-bounty-btn-delete-contact btn btn-link text-danger ' + ($root.form.contactDetails.length > 1?'':'hidden')"
                @click="removeContactDetails(index)"><i class="far fa-times"></i></button>
              <button type="button"
                v-bind:class="'new-bounty-btn-add-contact btn btn-link ' + ($root.form.contactDetails.length === index + 1?'':'invisible')"
                @click="addContactDetails()"><i class="far fa-plus"></i></button>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Show as Organisation -->
    <div class="mb-4">
      <label class="mb-1 font-subheader font-weight-normal letter-spacing">Show as Organisation</label>
      <p class="text-muted mb-0">Enter an organization GitHub link to display its logo and name on this bounty</p>
      <input class="form-control" id='new-bounty-organisation-url' name='organisationUrl' v-model="form.organisationUrl" type="url"
        placeholder="https://github.com/org/repo/issues/n" required />
    </div>
  </div>
</form-wrapper>